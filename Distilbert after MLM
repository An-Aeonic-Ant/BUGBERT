{"metadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.12"},"kaggle":{"accelerator":"gpu","dataSources":[{"sourceId":85506,"databundleVersionId":9687564,"sourceType":"competition"},{"sourceId":231386022,"sourceType":"kernelVersion"}],"isInternetEnabled":true,"language":"python","sourceType":"notebook","isGpuEnabled":true},"papermill":{"default_parameters":{},"duration":4440.201404,"end_time":"2025-02-13T13:11:47.815640","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-02-13T11:57:47.614236","version":"2.6.0"},"widgets":{"application/vnd.jupyter.widget-state+json":{"state":{"02e51e451b6643418515e642bfa3588f":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0720cea1fe564039807fa2f548a7ef6c":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_68f16ed5bfa64ae588a15af7925bd832","max":465,"min":0,"orientation":"horizontal","style":"IPY_MODEL_02e51e451b6643418515e642bfa3588f","tabbable":null,"tooltip":null,"value":465}},"0c41efb0a58a40ae98eba0ca568f6d8b":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_391241173e2a44d88b200e81060e1d09","placeholder":"​","style":"IPY_MODEL_2023e62bda1c41f8ba007f2d16e4310e","tabbable":null,"tooltip":null,"value":" 465/465 [00:00&lt;00:00, 47.1kB/s]"}},"10b84679f03e40bc9c67ffd80cddefc5":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"16483c3aca264723be68137b9c9a70eb":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"174c79b27c30485f86d510ca0e092fff":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_fd179fc43e94461bade1113d726a63bb","max":213450,"min":0,"orientation":"horizontal","style":"IPY_MODEL_dfd2c8cd96214ccfae552ea38ff2985d","tabbable":null,"tooltip":null,"value":213450}},"1e0e8250cd4346398c3b85f829a450f7":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2023e62bda1c41f8ba007f2d16e4310e":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"23e6d81822804f628855488d131c3449":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"29945fbe5eb74fb9a5a328695b9e9892":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f05d190fafa344fc9a7953c662430f83","IPY_MODEL_4c5aaa818ff1412dac4dd643c22404f5","IPY_MODEL_2efd8e2b72e54211940e159a4a1fda64"],"layout":"IPY_MODEL_cfd867e2fdf544d3befff06c15e865bf","tabbable":null,"tooltip":null}},"2b1e936f83474629a191f987fe5e2b33":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_a5f3970f1d8643a485c67fc5babbc4a7","placeholder":"​","style":"IPY_MODEL_cb6dd670ae574c0f90d06b8e27b487f6","tabbable":null,"tooltip":null,"value":"config.json: 100%"}},"2efd8e2b72e54211940e159a4a1fda64":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_16483c3aca264723be68137b9c9a70eb","placeholder":"​","style":"IPY_MODEL_f71fc760de08420c8af4eaa259fb77ca","tabbable":null,"tooltip":null,"value":" 49.0/49.0 [00:00&lt;00:00, 4.85kB/s]"}},"33e1fbd412334681b609b7450f942bff":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"391241173e2a44d88b200e81060e1d09":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"439ac71400e04113aa91da861609a420":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_e41232b9eaf141f29dee3c78048233a0","placeholder":"​","style":"IPY_MODEL_ea65ef8eb1dc446e8ce2a85cefbefe46","tabbable":null,"tooltip":null,"value":"tokenizer.json: 100%"}},"482f24ee37e04ef289d2547fdddfc812":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_e40f10b8360f42aba6b9c81b35e09c32","max":263260784,"min":0,"orientation":"horizontal","style":"IPY_MODEL_33e1fbd412334681b609b7450f942bff","tabbable":null,"tooltip":null,"value":263260784}},"49453e27640c4949bed43f78c60577da":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"4b92b8273ff845ee8441e4be70a49b20":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_2b1e936f83474629a191f987fe5e2b33","IPY_MODEL_0720cea1fe564039807fa2f548a7ef6c","IPY_MODEL_0c41efb0a58a40ae98eba0ca568f6d8b"],"layout":"IPY_MODEL_68bba6b51a9e4e13af476ec133b00af5","tabbable":null,"tooltip":null}},"4c5aaa818ff1412dac4dd643c22404f5":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_9ea0baeddb8b40a6996ec150c999344d","max":49,"min":0,"orientation":"horizontal","style":"IPY_MODEL_57e7913936ca47b19a41493d1e2342e1","tabbable":null,"tooltip":null,"value":49}},"4e400f67fd15436f9343ea8a5273326c":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"57e7913936ca47b19a41493d1e2342e1":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5b28af6909cc46f0bd7d421d32d680b1":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"5cd132683bef41e1978515a2c38615a5":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"62dcebfb426a4132a48a6639b90b1e22":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_af11e0d7663a44d48813983637a4873a","IPY_MODEL_482f24ee37e04ef289d2547fdddfc812","IPY_MODEL_99b1112ae02b44c69a47458a3f4dcbd7"],"layout":"IPY_MODEL_90501a8144ac49078eab62061bdd781f","tabbable":null,"tooltip":null}},"678939222ea444578e21cfcf8c357f04":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_1e0e8250cd4346398c3b85f829a450f7","max":435797,"min":0,"orientation":"horizontal","style":"IPY_MODEL_871bb2cb76b5425fa5c30eb970aee87b","tabbable":null,"tooltip":null,"value":435797}},"68bba6b51a9e4e13af476ec133b00af5":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"68f16ed5bfa64ae588a15af7925bd832":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6ded27aca19e478e8db3319335629637":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"807223cf668b4ce89c8bbd13f45350f2":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_fe10c6ddbc6146d19263e7a5166d499e","IPY_MODEL_174c79b27c30485f86d510ca0e092fff","IPY_MODEL_9ee6745d656b43c390c45b35f4da60c5"],"layout":"IPY_MODEL_10b84679f03e40bc9c67ffd80cddefc5","tabbable":null,"tooltip":null}},"871bb2cb76b5425fa5c30eb970aee87b":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"873f13aa0d33474cb347ce92dc80ab63":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"876eb0b4058241c5bf335c7adbcefc0e":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_b57fd5194e6e4afeb5ca92bd72df04aa","placeholder":"​","style":"IPY_MODEL_893817a1c96f4105b726831585e0ca46","tabbable":null,"tooltip":null,"value":" 436k/436k [00:00&lt;00:00, 7.32MB/s]"}},"893817a1c96f4105b726831585e0ca46":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"90501a8144ac49078eab62061bdd781f":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"92801315adb944fab73c6ef92d1f04f9":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_439ac71400e04113aa91da861609a420","IPY_MODEL_678939222ea444578e21cfcf8c357f04","IPY_MODEL_876eb0b4058241c5bf335c7adbcefc0e"],"layout":"IPY_MODEL_bb794bf6dcbf4c078a5d9b3d47ec9581","tabbable":null,"tooltip":null}},"933ed2f3ccd64919ab89c88fd4b87903":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"99b1112ae02b44c69a47458a3f4dcbd7":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_873f13aa0d33474cb347ce92dc80ab63","placeholder":"​","style":"IPY_MODEL_49453e27640c4949bed43f78c60577da","tabbable":null,"tooltip":null,"value":" 263M/263M [00:01&lt;00:00, 248MB/s]"}},"9ea0baeddb8b40a6996ec150c999344d":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9ee6745d656b43c390c45b35f4da60c5":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_933ed2f3ccd64919ab89c88fd4b87903","placeholder":"​","style":"IPY_MODEL_c09af80a9396448096b19b95a2d604fb","tabbable":null,"tooltip":null,"value":" 213k/213k [00:00&lt;00:00, 6.96MB/s]"}},"a08adc0b3e834d4dbdee1b9d47bf3a26":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"a5f3970f1d8643a485c67fc5babbc4a7":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"af11e0d7663a44d48813983637a4873a":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_6ded27aca19e478e8db3319335629637","placeholder":"​","style":"IPY_MODEL_5b28af6909cc46f0bd7d421d32d680b1","tabbable":null,"tooltip":null,"value":"model.safetensors: 100%"}},"b57fd5194e6e4afeb5ca92bd72df04aa":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bb794bf6dcbf4c078a5d9b3d47ec9581":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c09af80a9396448096b19b95a2d604fb":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"cb6dd670ae574c0f90d06b8e27b487f6":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"cfd867e2fdf544d3befff06c15e865bf":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dfd2c8cd96214ccfae552ea38ff2985d":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"e40f10b8360f42aba6b9c81b35e09c32":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e41232b9eaf141f29dee3c78048233a0":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ea65ef8eb1dc446e8ce2a85cefbefe46":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"f05d190fafa344fc9a7953c662430f83":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_5cd132683bef41e1978515a2c38615a5","placeholder":"​","style":"IPY_MODEL_4e400f67fd15436f9343ea8a5273326c","tabbable":null,"tooltip":null,"value":"tokenizer_config.json: 100%"}},"f71fc760de08420c8af4eaa259fb77ca":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"fd179fc43e94461bade1113d726a63bb":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fe10c6ddbc6146d19263e7a5166d499e":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_23e6d81822804f628855488d131c3449","placeholder":"​","style":"IPY_MODEL_a08adc0b3e834d4dbdee1b9d47bf3a26","tabbable":null,"tooltip":null,"value":"vocab.txt: 100%"}}},"version_major":2,"version_minor":0}}},"nbformat_minor":5,"nbformat":4,"cells":[{"id":"2eb0374c","cell_type":"code","source":"from transformers import AutoModelForSequenceClassification, AutoTokenizer, Trainer, TrainingArguments,EarlyStoppingCallback\nimport pandas as pd\nfrom datasets import Dataset\nimport torch\nimport numpy as np\nfrom safetensors.torch import load_file","metadata":{"execution":{"iopub.execute_input":"2025-02-13T11:57:50.151559Z","iopub.status.busy":"2025-02-13T11:57:50.151255Z","iopub.status.idle":"2025-02-13T11:58:14.228686Z","shell.execute_reply":"2025-02-13T11:58:14.227648Z"},"papermill":{"duration":24.084324,"end_time":"2025-02-13T11:58:14.230384","exception":false,"start_time":"2025-02-13T11:57:50.146060","status":"completed"},"tags":[]},"outputs":[],"execution_count":1},{"id":"7b514631","cell_type":"code","source":"df=pd.read_csv(\"/kaggle/input/isec-sdc-2025/train.csv\")\ntest_df=pd.read_csv(\"/kaggle/input/isec-sdc-2025/test.csv\")","metadata":{"execution":{"iopub.execute_input":"2025-02-13T11:58:14.242232Z","iopub.status.busy":"2025-02-13T11:58:14.241686Z","iopub.status.idle":"2025-02-13T11:58:15.341553Z","shell.execute_reply":"2025-02-13T11:58:15.340727Z"},"papermill":{"duration":1.107572,"end_time":"2025-02-13T11:58:15.343116","exception":false,"start_time":"2025-02-13T11:58:14.235544","status":"completed"},"tags":[]},"outputs":[],"execution_count":2},{"id":"a6b172d1","cell_type":"code","source":"# df,test_df=df[:1000],test_df[:100]","metadata":{"execution":{"iopub.execute_input":"2025-02-13T11:58:15.351641Z","iopub.status.busy":"2025-02-13T11:58:15.351413Z","iopub.status.idle":"2025-02-13T11:58:15.354438Z","shell.execute_reply":"2025-02-13T11:58:15.353703Z"},"papermill":{"duration":0.008635,"end_time":"2025-02-13T11:58:15.355739","exception":false,"start_time":"2025-02-13T11:58:15.347104","status":"completed"},"tags":[]},"outputs":[],"execution_count":3},{"id":"5766830d","cell_type":"code","source":"df[\"Description\"]=df[\"Description\"].fillna(\"Not provided\")\ntest_df[\"Description\"]=test_df[\"Description\"].fillna(\"Not provided\")","metadata":{"execution":{"iopub.execute_input":"2025-02-13T11:58:15.364317Z","iopub.status.busy":"2025-02-13T11:58:15.364080Z","iopub.status.idle":"2025-02-13T11:58:15.378832Z","shell.execute_reply":"2025-02-13T11:58:15.378059Z"},"papermill":{"duration":0.020611,"end_time":"2025-02-13T11:58:15.380078","exception":false,"start_time":"2025-02-13T11:58:15.359467","status":"completed"},"tags":[]},"outputs":[],"execution_count":4},{"id":"a471b141","cell_type":"code","source":"from sklearn.model_selection import train_test_split\ntrain_df, val_df = train_test_split(df, test_size=0.25, random_state=7,stratify=df['Priority'])","metadata":{"execution":{"iopub.execute_input":"2025-02-13T11:58:15.388360Z","iopub.status.busy":"2025-02-13T11:58:15.388105Z","iopub.status.idle":"2025-02-13T11:58:15.442815Z","shell.execute_reply":"2025-02-13T11:58:15.442004Z"},"papermill":{"duration":0.060303,"end_time":"2025-02-13T11:58:15.444252","exception":false,"start_time":"2025-02-13T11:58:15.383949","status":"completed"},"tags":[]},"outputs":[],"execution_count":5},{"id":"e2b0c68a","cell_type":"code","source":"print(train_df.shape)\nprint(val_df.shape)\nprint(test_df.shape)","metadata":{"execution":{"iopub.execute_input":"2025-02-13T11:58:15.452294Z","iopub.status.busy":"2025-02-13T11:58:15.452044Z","iopub.status.idle":"2025-02-13T11:58:15.456761Z","shell.execute_reply":"2025-02-13T11:58:15.456021Z"},"papermill":{"duration":0.010401,"end_time":"2025-02-13T11:58:15.458333","exception":false,"start_time":"2025-02-13T11:58:15.447932","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["(39745, 7)\n","(13249, 7)\n","(1328, 6)\n"]}],"execution_count":6},{"id":"5e74de6f","cell_type":"code","source":"from sklearn.utils.class_weight import compute_class_weight\n\nclass_weights = compute_class_weight(class_weight='balanced', classes=np.unique(df[\"Priority\"]), y=df[\"Priority\"])\n\nprint(class_weights)","metadata":{"execution":{"iopub.execute_input":"2025-02-13T11:58:15.472633Z","iopub.status.busy":"2025-02-13T11:58:15.472390Z","iopub.status.idle":"2025-02-13T11:58:15.485540Z","shell.execute_reply":"2025-02-13T11:58:15.484679Z"},"papermill":{"duration":0.021733,"end_time":"2025-02-13T11:58:15.486926","exception":false,"start_time":"2025-02-13T11:58:15.465193","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["[1.1851504  1.12609435 0.34020672 4.63436817 8.84707846]\n"]}],"execution_count":7},{"id":"55cfd689","cell_type":"code","source":"tokenizer = AutoTokenizer.from_pretrained(\"distilbert-base-cased\")\nmodel = AutoModelForSequenceClassification.from_pretrained('distilbert-base-cased', num_labels=5,output_hidden_states=True,trust_remote_code=True)\nfrom safetensors.torch import load_file\nstate_dict = load_file(\"/kaggle/input/bert-mlm/saved_model/model.safetensors\")\n\n# Load the state into the model\nmodel.load_state_dict(state_dict,strict=False)","metadata":{"execution":{"iopub.execute_input":"2025-02-13T11:58:15.495546Z","iopub.status.busy":"2025-02-13T11:58:15.495319Z","iopub.status.idle":"2025-02-13T11:58:20.849060Z","shell.execute_reply":"2025-02-13T11:58:20.848064Z"},"papermill":{"duration":5.359978,"end_time":"2025-02-13T11:58:20.850795","exception":false,"start_time":"2025-02-13T11:58:15.490817","status":"completed"},"tags":[]},"outputs":[{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"29945fbe5eb74fb9a5a328695b9e9892","version_major":2,"version_minor":0},"text/plain":["tokenizer_config.json:   0%|          | 0.00/49.0 [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"},{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"4b92b8273ff845ee8441e4be70a49b20","version_major":2,"version_minor":0},"text/plain":["config.json:   0%|          | 0.00/465 [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"},{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"807223cf668b4ce89c8bbd13f45350f2","version_major":2,"version_minor":0},"text/plain":["vocab.txt:   0%|          | 0.00/213k [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"},{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"92801315adb944fab73c6ef92d1f04f9","version_major":2,"version_minor":0},"text/plain":["tokenizer.json:   0%|          | 0.00/436k [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"},{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"62dcebfb426a4132a48a6639b90b1e22","version_major":2,"version_minor":0},"text/plain":["model.safetensors:   0%|          | 0.00/263M [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"},{"name":"stderr","output_type":"stream","text":["Some weights of DistilBertForSequenceClassification were not initialized from the model checkpoint at distilbert-base-cased and are newly initialized: ['classifier.bias', 'classifier.weight', 'pre_classifier.bias', 'pre_classifier.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"]},{"data":{"text/plain":["_IncompatibleKeys(missing_keys=['pre_classifier.weight', 'pre_classifier.bias', 'classifier.weight', 'classifier.bias'], unexpected_keys=['vocab_layer_norm.bias', 'vocab_layer_norm.weight', 'vocab_projector.bias', 'vocab_transform.bias', 'vocab_transform.weight'])"]},"execution_count":8,"metadata":{},"output_type":"execute_result"}],"execution_count":8},{"id":"3ec61926","cell_type":"code","source":"device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\nmodel.to(device)  # Move model to device\nclass_weights_tensor = torch.tensor(class_weights, dtype=torch.float32).to(device)","metadata":{"execution":{"iopub.execute_input":"2025-02-13T11:58:20.865815Z","iopub.status.busy":"2025-02-13T11:58:20.865566Z","iopub.status.idle":"2025-02-13T11:58:21.210647Z","shell.execute_reply":"2025-02-13T11:58:21.209940Z"},"papermill":{"duration":0.351605,"end_time":"2025-02-13T11:58:21.212136","exception":false,"start_time":"2025-02-13T11:58:20.860531","status":"completed"},"tags":[]},"outputs":[],"execution_count":9},{"id":"bbde95d8","cell_type":"code","source":"def tokenize_data(components, titles, descriptions,statuss,resolutions,max_length=512):\n    combined_texts = [f\"{status} [SEP] {resolution} [SEP] {component} [SEP] {title} [SEP] {description}\" \n                      for status,resolution,component, title, description in zip(statuss,resolutions,components, titles, descriptions)]\n    \n    # Tokenize the combined texts\n    inputs = tokenizer(combined_texts, padding=True, truncation=True, return_tensors=\"pt\", max_length=max_length)\n    \n    return inputs","metadata":{"execution":{"iopub.execute_input":"2025-02-13T11:58:21.221957Z","iopub.status.busy":"2025-02-13T11:58:21.221727Z","iopub.status.idle":"2025-02-13T11:58:21.225564Z","shell.execute_reply":"2025-02-13T11:58:21.224934Z"},"papermill":{"duration":0.009907,"end_time":"2025-02-13T11:58:21.226714","exception":false,"start_time":"2025-02-13T11:58:21.216807","status":"completed"},"tags":[]},"outputs":[],"execution_count":10},{"id":"1cfdd8c8","cell_type":"code","source":"def create_dataset(inputs,labels):\n    data = Dataset.from_dict({\n            'input_ids': inputs['input_ids'],\n            'attention_mask': inputs['attention_mask'],\n            'labels': labels\n        })\n    return data","metadata":{"execution":{"iopub.execute_input":"2025-02-13T11:58:21.235928Z","iopub.status.busy":"2025-02-13T11:58:21.235727Z","iopub.status.idle":"2025-02-13T11:58:21.238958Z","shell.execute_reply":"2025-02-13T11:58:21.238360Z"},"papermill":{"duration":0.008994,"end_time":"2025-02-13T11:58:21.239999","exception":false,"start_time":"2025-02-13T11:58:21.231005","status":"completed"},"tags":[]},"outputs":[],"execution_count":11},{"id":"3d5867a6","cell_type":"code","source":"train_inputs=tokenize_data(train_df[\"Component\"],train_df[\"Title\"],train_df[\"Description\"],train_df[\"Status\"],train_df[\"Resolution\"])\nval_inputs=tokenize_data(val_df[\"Component\"],val_df[\"Title\"],val_df[\"Description\"],val_df[\"Status\"],val_df[\"Resolution\"])\ntest_inputs=tokenize_data(test_df[\"Component\"],test_df[\"Title\"],test_df[\"Description\"],test_df[\"Status\"],test_df[\"Resolution\"])","metadata":{"execution":{"iopub.execute_input":"2025-02-13T11:58:21.248969Z","iopub.status.busy":"2025-02-13T11:58:21.248746Z","iopub.status.idle":"2025-02-13T11:58:47.588691Z","shell.execute_reply":"2025-02-13T11:58:47.587977Z"},"papermill":{"duration":26.346102,"end_time":"2025-02-13T11:58:47.590300","exception":false,"start_time":"2025-02-13T11:58:21.244198","status":"completed"},"tags":[]},"outputs":[],"execution_count":12},{"id":"20e43982","cell_type":"code","source":"train_data=create_dataset(train_inputs,train_df[\"Priority\"])\nval_data=create_dataset(val_inputs,val_df[\"Priority\"])","metadata":{"execution":{"iopub.execute_input":"2025-02-13T11:58:47.600419Z","iopub.status.busy":"2025-02-13T11:58:47.600106Z","iopub.status.idle":"2025-02-13T11:58:51.433773Z","shell.execute_reply":"2025-02-13T11:58:51.433093Z"},"papermill":{"duration":3.840213,"end_time":"2025-02-13T11:58:51.435341","exception":false,"start_time":"2025-02-13T11:58:47.595128","status":"completed"},"tags":[]},"outputs":[],"execution_count":13},{"id":"cc8d037b","cell_type":"code","source":"class WeightedTrainer(Trainer):\n    def compute_loss(self, model, inputs, return_outputs=False, num_items_in_batch=None):\n        # print(inputs)  # Debugging: Check input structure\n\n        labels = inputs.pop(\"labels\")  # Extract labels\n        outputs = model(**inputs)  \n        logits = outputs.logits  # Extract raw logits (not loss!)\n\n        # Compute per-sample loss\n        loss_fct = torch.nn.CrossEntropyLoss(reduction=\"none\")  # Keep per-sample loss\n        loss = loss_fct(logits, labels)  # Loss is now a tensor\n\n        # Fetch sample weights based on labels\n        sample_weights = class_weights_tensor[labels]  \n        # print(\"Sample Weights:\", sample_weights)  # Debugging\n\n        # Apply sample weights to per-sample loss\n        weighted_loss = (loss * sample_weights).mean()  # Scalar loss\n\n        return (weighted_loss, outputs) if return_outputs else weighted_loss","metadata":{"execution":{"iopub.execute_input":"2025-02-13T11:58:51.445348Z","iopub.status.busy":"2025-02-13T11:58:51.445081Z","iopub.status.idle":"2025-02-13T11:58:51.449417Z","shell.execute_reply":"2025-02-13T11:58:51.448779Z"},"papermill":{"duration":0.010582,"end_time":"2025-02-13T11:58:51.450675","exception":false,"start_time":"2025-02-13T11:58:51.440093","status":"completed"},"tags":[]},"outputs":[],"execution_count":14},{"id":"e7925ee9","cell_type":"code","source":"def fine_tune_model(train_data,val_data,epochs=5):\n    training_args = TrainingArguments(\n        output_dir='./results',\n        overwrite_output_dir=True,\n        logging_dir='./logs',\n        logging_strategy=\"steps\",\n        logging_steps=1500,\n        warmup_steps=1000,\n        eval_steps=1500,\n        save_steps=1500,\n        num_train_epochs=epochs,\n        per_device_eval_batch_size=64,\n        per_device_train_batch_size=16,\n        # gradient_accumulation_steps=2,  # Gradient accumulation step size\n        seed=7,\n        fp16=True,\n        report_to=[],\n        optim=\"adafactor\",\n        weight_decay=0.01,\n        eval_strategy=\"steps\", \n        save_strategy=\"steps\",\n        load_best_model_at_end=True,\n        save_total_limit=2,\n        disable_tqdm=True,\n        # learning_rate=2e-05\n    )\n\n    # Initialize Trainer\n    trainer = WeightedTrainer(\n        model=model,\n        args=training_args,\n        train_dataset=train_data,\n        eval_dataset=val_data,\n        callbacks = [EarlyStoppingCallback(early_stopping_patience=1)]\n    )\n\n    # Train the model\n    trainer.train()\n","metadata":{"execution":{"iopub.execute_input":"2025-02-13T11:58:51.460073Z","iopub.status.busy":"2025-02-13T11:58:51.459873Z","iopub.status.idle":"2025-02-13T11:58:51.464210Z","shell.execute_reply":"2025-02-13T11:58:51.463615Z"},"papermill":{"duration":0.010239,"end_time":"2025-02-13T11:58:51.465337","exception":false,"start_time":"2025-02-13T11:58:51.455098","status":"completed"},"tags":[]},"outputs":[],"execution_count":15},{"id":"196b1be7","cell_type":"code","source":"fine_tune_model(train_data,val_data)","metadata":{"execution":{"iopub.execute_input":"2025-02-13T11:58:51.474426Z","iopub.status.busy":"2025-02-13T11:58:51.474217Z","iopub.status.idle":"2025-02-13T13:03:56.875705Z","shell.execute_reply":"2025-02-13T13:03:56.874766Z"},"papermill":{"duration":3905.412002,"end_time":"2025-02-13T13:03:56.881590","exception":false,"start_time":"2025-02-13T11:58:51.469588","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["{'loss': 1.572, 'grad_norm': 4.398486614227295, 'learning_rate': 1.9900000000000003e-05, 'epoch': 0.32180209171359614}\n","{'eval_loss': 1.5646586418151855, 'eval_runtime': 107.7429, 'eval_samples_per_second': 122.969, 'eval_steps_per_second': 1.931, 'epoch': 0.32180209171359614}\n","{'loss': 1.5149, 'grad_norm': 15.27309799194336, 'learning_rate': 1.7606734816596514e-05, 'epoch': 0.6436041834271923}\n","{'eval_loss': 1.4297691583633423, 'eval_runtime': 107.7841, 'eval_samples_per_second': 122.922, 'eval_steps_per_second': 1.93, 'epoch': 0.6436041834271923}\n","{'loss': 1.4388, 'grad_norm': 10.779828071594238, 'learning_rate': 1.5213469633193025e-05, 'epoch': 0.9654062751407884}\n","{'eval_loss': 1.431618332862854, 'eval_runtime': 107.7738, 'eval_samples_per_second': 122.933, 'eval_steps_per_second': 1.93, 'epoch': 0.9654062751407884}\n","{'loss': 1.3822, 'grad_norm': 9.432497024536133, 'learning_rate': 1.280817799158148e-05, 'epoch': 1.2864038616251006}\n","{'eval_loss': 1.395633339881897, 'eval_runtime': 107.7786, 'eval_samples_per_second': 122.928, 'eval_steps_per_second': 1.93, 'epoch': 1.2864038616251006}\n","{'loss': 1.3382, 'grad_norm': 14.38496208190918, 'learning_rate': 1.0402886349969934e-05, 'epoch': 1.6082059533386968}\n","{'eval_loss': 1.3772516250610352, 'eval_runtime': 107.8333, 'eval_samples_per_second': 122.866, 'eval_steps_per_second': 1.929, 'epoch': 1.6082059533386968}\n","{'loss': 1.2713, 'grad_norm': 8.489977836608887, 'learning_rate': 7.99759470835839e-06, 'epoch': 1.930008045052293}\n","{'eval_loss': 1.3488754034042358, 'eval_runtime': 107.84, 'eval_samples_per_second': 122.858, 'eval_steps_per_second': 1.929, 'epoch': 1.930008045052293}\n","{'loss': 1.2138, 'grad_norm': 12.595502853393555, 'learning_rate': 5.592303066746844e-06, 'epoch': 2.251005631536605}\n","{'eval_loss': 1.3678884506225586, 'eval_runtime': 107.8219, 'eval_samples_per_second': 122.879, 'eval_steps_per_second': 1.929, 'epoch': 2.251005631536605}\n","{'loss': 1.2175, 'grad_norm': 22.23754119873047, 'learning_rate': 3.187011425135298e-06, 'epoch': 2.572807723250201}\n","{'eval_loss': 1.364991307258606, 'eval_runtime': 107.7739, 'eval_samples_per_second': 122.933, 'eval_steps_per_second': 1.93, 'epoch': 2.572807723250201}\n","{'loss': 1.2022, 'grad_norm': 11.761208534240723, 'learning_rate': 7.817197835237524e-07, 'epoch': 2.8946098149637973}\n","{'eval_loss': 1.3690146207809448, 'eval_runtime': 107.7884, 'eval_samples_per_second': 122.917, 'eval_steps_per_second': 1.93, 'epoch': 2.8946098149637973}\n","{'train_runtime': 3905.0474, 'train_samples_per_second': 30.534, 'train_steps_per_second': 0.477, 'train_loss': 1.3438624956885525, 'epoch': 2.9959774738535803}\n"]}],"execution_count":16},{"id":"15edeab7","cell_type":"code","source":"def get_embeddings(inputs,batch_size=64):\n    model.eval()\n    all_embeddings=[]\n    input_ids = inputs['input_ids']\n    attention_mask = inputs['attention_mask']\n\n    with torch.no_grad():  # Disable gradient calculation\n        for i in range(0, len(input_ids), batch_size):\n            print(f\"Processing batch {i // batch_size + 1}/{(len(input_ids) // batch_size) + 1}\")\n\n            # Slice batch inputs\n            batch_input_ids = input_ids[i:i+batch_size].to(model.device)  # Ensure input is on the correct device\n            batch_attention_mask = attention_mask[i:i+batch_size].to(model.device)\n\n            # Run inference\n            outputs = model(input_ids=batch_input_ids, attention_mask=batch_attention_mask, output_hidden_states=True)\n            hidden_states = outputs.hidden_states\n\n            # Extract embeddings for CLS token\n            cls_embeddings = hidden_states[-1][:, 0, :].cpu().numpy()  # Move to CPU and convert to numpy\n            all_embeddings.extend(cls_embeddings)\n\n    # Convert list of embeddings to DataFrame\n    embeddings_df = pd.DataFrame(all_embeddings)\n    return embeddings_df","metadata":{"execution":{"iopub.execute_input":"2025-02-13T13:03:56.892816Z","iopub.status.busy":"2025-02-13T13:03:56.892579Z","iopub.status.idle":"2025-02-13T13:03:56.897861Z","shell.execute_reply":"2025-02-13T13:03:56.897211Z"},"papermill":{"duration":0.012194,"end_time":"2025-02-13T13:03:56.898979","exception":false,"start_time":"2025-02-13T13:03:56.886785","status":"completed"},"tags":[]},"outputs":[],"execution_count":17},{"id":"6036d69c","cell_type":"code","source":"train_embedded=get_embeddings(train_inputs)\nval_embedded=get_embeddings(val_inputs)\ntest_embedded=get_embeddings(test_inputs)","metadata":{"_kg_hide-output":true,"execution":{"iopub.execute_input":"2025-02-13T13:03:56.909881Z","iopub.status.busy":"2025-02-13T13:03:56.909625Z","iopub.status.idle":"2025-02-13T13:11:07.094356Z","shell.execute_reply":"2025-02-13T13:11:07.093618Z"},"papermill":{"duration":430.191991,"end_time":"2025-02-13T13:11:07.095934","exception":false,"start_time":"2025-02-13T13:03:56.903943","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Processing batch 1/622\n","Processing batch 2/622\n","Processing batch 3/622\n","Processing batch 4/622\n","Processing batch 5/622\n","Processing batch 6/622\n","Processing batch 7/622\n","Processing batch 8/622\n","Processing batch 9/622\n","Processing batch 10/622\n","Processing batch 11/622\n","Processing batch 12/622\n","Processing batch 13/622\n","Processing batch 14/622\n","Processing batch 15/622\n","Processing batch 16/622\n","Processing batch 17/622\n","Processing batch 18/622\n","Processing batch 19/622\n","Processing batch 20/622\n","Processing batch 21/622\n","Processing batch 22/622\n","Processing batch 23/622\n","Processing batch 24/622\n","Processing batch 25/622\n","Processing batch 26/622\n","Processing batch 27/622\n","Processing batch 28/622\n","Processing batch 29/622\n","Processing batch 30/622\n","Processing batch 31/622\n","Processing batch 32/622\n","Processing batch 33/622\n","Processing batch 34/622\n","Processing batch 35/622\n","Processing batch 36/622\n","Processing batch 37/622\n","Processing batch 38/622\n","Processing batch 39/622\n","Processing batch 40/622\n","Processing batch 41/622\n","Processing batch 42/622\n","Processing batch 43/622\n","Processing batch 44/622\n","Processing batch 45/622\n","Processing batch 46/622\n","Processing batch 47/622\n","Processing batch 48/622\n","Processing batch 49/622\n","Processing batch 50/622\n","Processing batch 51/622\n","Processing batch 52/622\n","Processing batch 53/622\n","Processing batch 54/622\n","Processing batch 55/622\n","Processing batch 56/622\n","Processing batch 57/622\n","Processing batch 58/622\n","Processing batch 59/622\n","Processing batch 60/622\n","Processing batch 61/622\n","Processing batch 62/622\n","Processing batch 63/622\n","Processing batch 64/622\n","Processing batch 65/622\n","Processing batch 66/622\n","Processing batch 67/622\n","Processing batch 68/622\n","Processing batch 69/622\n","Processing batch 70/622\n","Processing batch 71/622\n","Processing batch 72/622\n","Processing batch 73/622\n","Processing batch 74/622\n","Processing batch 75/622\n","Processing batch 76/622\n","Processing batch 77/622\n","Processing batch 78/622\n","Processing batch 79/622\n","Processing batch 80/622\n","Processing batch 81/622\n","Processing batch 82/622\n","Processing batch 83/622\n","Processing batch 84/622\n","Processing batch 85/622\n","Processing batch 86/622\n","Processing batch 87/622\n","Processing batch 88/622\n","Processing batch 89/622\n","Processing batch 90/622\n","Processing batch 91/622\n","Processing batch 92/622\n","Processing batch 93/622\n","Processing batch 94/622\n","Processing batch 95/622\n","Processing batch 96/622\n","Processing batch 97/622\n","Processing batch 98/622\n","Processing batch 99/622\n","Processing batch 100/622\n","Processing batch 101/622\n","Processing batch 102/622\n","Processing batch 103/622\n","Processing batch 104/622\n","Processing batch 105/622\n","Processing batch 106/622\n","Processing batch 107/622\n","Processing batch 108/622\n","Processing batch 109/622\n","Processing batch 110/622\n","Processing batch 111/622\n","Processing batch 112/622\n","Processing batch 113/622\n","Processing batch 114/622\n","Processing batch 115/622\n","Processing batch 116/622\n","Processing batch 117/622\n","Processing batch 118/622\n","Processing batch 119/622\n","Processing batch 120/622\n","Processing batch 121/622\n","Processing batch 122/622\n","Processing batch 123/622\n","Processing batch 124/622\n","Processing batch 125/622\n","Processing batch 126/622\n","Processing batch 127/622\n","Processing batch 128/622\n","Processing batch 129/622\n","Processing batch 130/622\n","Processing batch 131/622\n","Processing batch 132/622\n","Processing batch 133/622\n","Processing batch 134/622\n","Processing batch 135/622\n","Processing batch 136/622\n","Processing batch 137/622\n","Processing batch 138/622\n","Processing batch 139/622\n","Processing batch 140/622\n","Processing batch 141/622\n","Processing batch 142/622\n","Processing batch 143/622\n","Processing batch 144/622\n","Processing batch 145/622\n","Processing batch 146/622\n","Processing batch 147/622\n","Processing batch 148/622\n","Processing batch 149/622\n","Processing batch 150/622\n","Processing batch 151/622\n","Processing batch 152/622\n","Processing batch 153/622\n","Processing batch 154/622\n","Processing batch 155/622\n","Processing batch 156/622\n","Processing batch 157/622\n","Processing batch 158/622\n","Processing batch 159/622\n","Processing batch 160/622\n","Processing batch 161/622\n","Processing batch 162/622\n","Processing batch 163/622\n","Processing batch 164/622\n","Processing batch 165/622\n","Processing batch 166/622\n","Processing batch 167/622\n","Processing batch 168/622\n","Processing batch 169/622\n","Processing batch 170/622\n","Processing batch 171/622\n","Processing batch 172/622\n","Processing batch 173/622\n","Processing batch 174/622\n","Processing batch 175/622\n","Processing batch 176/622\n","Processing batch 177/622\n","Processing batch 178/622\n","Processing batch 179/622\n","Processing batch 180/622\n","Processing batch 181/622\n","Processing batch 182/622\n","Processing batch 183/622\n","Processing batch 184/622\n","Processing batch 185/622\n","Processing batch 186/622\n","Processing batch 187/622\n","Processing batch 188/622\n","Processing batch 189/622\n","Processing batch 190/622\n","Processing batch 191/622\n","Processing batch 192/622\n","Processing batch 193/622\n","Processing batch 194/622\n","Processing batch 195/622\n","Processing batch 196/622\n","Processing batch 197/622\n","Processing batch 198/622\n","Processing batch 199/622\n","Processing batch 200/622\n","Processing batch 201/622\n","Processing batch 202/622\n","Processing batch 203/622\n","Processing batch 204/622\n","Processing batch 205/622\n","Processing batch 206/622\n","Processing batch 207/622\n","Processing batch 208/622\n","Processing batch 209/622\n","Processing batch 210/622\n","Processing batch 211/622\n","Processing batch 212/622\n","Processing batch 213/622\n","Processing batch 214/622\n","Processing batch 215/622\n","Processing batch 216/622\n","Processing batch 217/622\n","Processing batch 218/622\n","Processing batch 219/622\n","Processing batch 220/622\n","Processing batch 221/622\n","Processing batch 222/622\n","Processing batch 223/622\n","Processing batch 224/622\n","Processing batch 225/622\n","Processing batch 226/622\n","Processing batch 227/622\n","Processing batch 228/622\n","Processing batch 229/622\n","Processing batch 230/622\n","Processing batch 231/622\n","Processing batch 232/622\n","Processing batch 233/622\n","Processing batch 234/622\n","Processing batch 235/622\n","Processing batch 236/622\n","Processing batch 237/622\n","Processing batch 238/622\n","Processing batch 239/622\n","Processing batch 240/622\n","Processing batch 241/622\n","Processing batch 242/622\n","Processing batch 243/622\n","Processing batch 244/622\n","Processing batch 245/622\n","Processing batch 246/622\n","Processing batch 247/622\n","Processing batch 248/622\n","Processing batch 249/622\n","Processing batch 250/622\n","Processing batch 251/622\n","Processing batch 252/622\n","Processing batch 253/622\n","Processing batch 254/622\n","Processing batch 255/622\n","Processing batch 256/622\n","Processing batch 257/622\n","Processing batch 258/622\n","Processing batch 259/622\n","Processing batch 260/622\n","Processing batch 261/622\n","Processing batch 262/622\n","Processing batch 263/622\n","Processing batch 264/622\n","Processing batch 265/622\n","Processing batch 266/622\n","Processing batch 267/622\n","Processing batch 268/622\n","Processing batch 269/622\n","Processing batch 270/622\n","Processing batch 271/622\n","Processing batch 272/622\n","Processing batch 273/622\n","Processing batch 274/622\n","Processing batch 275/622\n","Processing batch 276/622\n","Processing batch 277/622\n","Processing batch 278/622\n","Processing batch 279/622\n","Processing batch 280/622\n","Processing batch 281/622\n","Processing batch 282/622\n","Processing batch 283/622\n","Processing batch 284/622\n","Processing batch 285/622\n","Processing batch 286/622\n","Processing batch 287/622\n","Processing batch 288/622\n","Processing batch 289/622\n","Processing batch 290/622\n","Processing batch 291/622\n","Processing batch 292/622\n","Processing batch 293/622\n","Processing batch 294/622\n","Processing batch 295/622\n","Processing batch 296/622\n","Processing batch 297/622\n","Processing batch 298/622\n","Processing batch 299/622\n","Processing batch 300/622\n","Processing batch 301/622\n","Processing batch 302/622\n","Processing batch 303/622\n","Processing batch 304/622\n","Processing batch 305/622\n","Processing batch 306/622\n","Processing batch 307/622\n","Processing batch 308/622\n","Processing batch 309/622\n","Processing batch 310/622\n","Processing batch 311/622\n","Processing batch 312/622\n","Processing batch 313/622\n","Processing batch 314/622\n","Processing batch 315/622\n","Processing batch 316/622\n","Processing batch 317/622\n","Processing batch 318/622\n","Processing batch 319/622\n","Processing batch 320/622\n","Processing batch 321/622\n","Processing batch 322/622\n","Processing batch 323/622\n","Processing batch 324/622\n","Processing batch 325/622\n","Processing batch 326/622\n","Processing batch 327/622\n","Processing batch 328/622\n","Processing batch 329/622\n","Processing batch 330/622\n","Processing batch 331/622\n","Processing batch 332/622\n","Processing batch 333/622\n","Processing batch 334/622\n","Processing batch 335/622\n","Processing batch 336/622\n","Processing batch 337/622\n","Processing batch 338/622\n","Processing batch 339/622\n","Processing batch 340/622\n","Processing batch 341/622\n","Processing batch 342/622\n","Processing batch 343/622\n","Processing batch 344/622\n","Processing batch 345/622\n","Processing batch 346/622\n","Processing batch 347/622\n","Processing batch 348/622\n","Processing batch 349/622\n","Processing batch 350/622\n","Processing batch 351/622\n","Processing batch 352/622\n","Processing batch 353/622\n","Processing batch 354/622\n","Processing batch 355/622\n","Processing batch 356/622\n","Processing batch 357/622\n","Processing batch 358/622\n","Processing batch 359/622\n","Processing batch 360/622\n","Processing batch 361/622\n","Processing batch 362/622\n","Processing batch 363/622\n","Processing batch 364/622\n","Processing batch 365/622\n","Processing batch 366/622\n","Processing batch 367/622\n","Processing batch 368/622\n","Processing batch 369/622\n","Processing batch 370/622\n","Processing batch 371/622\n","Processing batch 372/622\n","Processing batch 373/622\n","Processing batch 374/622\n","Processing batch 375/622\n","Processing batch 376/622\n","Processing batch 377/622\n","Processing batch 378/622\n","Processing batch 379/622\n","Processing batch 380/622\n","Processing batch 381/622\n","Processing batch 382/622\n","Processing batch 383/622\n","Processing batch 384/622\n","Processing batch 385/622\n","Processing batch 386/622\n","Processing batch 387/622\n","Processing batch 388/622\n","Processing batch 389/622\n","Processing batch 390/622\n","Processing batch 391/622\n","Processing batch 392/622\n","Processing batch 393/622\n","Processing batch 394/622\n","Processing batch 395/622\n","Processing batch 396/622\n","Processing batch 397/622\n","Processing batch 398/622\n","Processing batch 399/622\n","Processing batch 400/622\n","Processing batch 401/622\n","Processing batch 402/622\n","Processing batch 403/622\n","Processing batch 404/622\n","Processing batch 405/622\n","Processing batch 406/622\n","Processing batch 407/622\n","Processing batch 408/622\n","Processing batch 409/622\n","Processing batch 410/622\n","Processing batch 411/622\n","Processing batch 412/622\n","Processing batch 413/622\n","Processing batch 414/622\n","Processing batch 415/622\n","Processing batch 416/622\n","Processing batch 417/622\n","Processing batch 418/622\n","Processing batch 419/622\n","Processing batch 420/622\n","Processing batch 421/622\n","Processing batch 422/622\n","Processing batch 423/622\n","Processing batch 424/622\n","Processing batch 425/622\n","Processing batch 426/622\n","Processing batch 427/622\n","Processing batch 428/622\n","Processing batch 429/622\n","Processing batch 430/622\n","Processing batch 431/622\n","Processing batch 432/622\n","Processing batch 433/622\n","Processing batch 434/622\n","Processing batch 435/622\n","Processing batch 436/622\n","Processing batch 437/622\n","Processing batch 438/622\n","Processing batch 439/622\n","Processing batch 440/622\n","Processing batch 441/622\n","Processing batch 442/622\n","Processing batch 443/622\n","Processing batch 444/622\n","Processing batch 445/622\n","Processing batch 446/622\n","Processing batch 447/622\n","Processing batch 448/622\n","Processing batch 449/622\n","Processing batch 450/622\n","Processing batch 451/622\n","Processing batch 452/622\n","Processing batch 453/622\n","Processing batch 454/622\n","Processing batch 455/622\n","Processing batch 456/622\n","Processing batch 457/622\n","Processing batch 458/622\n","Processing batch 459/622\n","Processing batch 460/622\n","Processing batch 461/622\n","Processing batch 462/622\n","Processing batch 463/622\n","Processing batch 464/622\n","Processing batch 465/622\n","Processing batch 466/622\n","Processing batch 467/622\n","Processing batch 468/622\n","Processing batch 469/622\n","Processing batch 470/622\n","Processing batch 471/622\n","Processing batch 472/622\n","Processing batch 473/622\n","Processing batch 474/622\n","Processing batch 475/622\n","Processing batch 476/622\n","Processing batch 477/622\n","Processing batch 478/622\n","Processing batch 479/622\n","Processing batch 480/622\n","Processing batch 481/622\n","Processing batch 482/622\n","Processing batch 483/622\n","Processing batch 484/622\n","Processing batch 485/622\n","Processing batch 486/622\n","Processing batch 487/622\n","Processing batch 488/622\n","Processing batch 489/622\n","Processing batch 490/622\n","Processing batch 491/622\n","Processing batch 492/622\n","Processing batch 493/622\n","Processing batch 494/622\n","Processing batch 495/622\n","Processing batch 496/622\n","Processing batch 497/622\n","Processing batch 498/622\n","Processing batch 499/622\n","Processing batch 500/622\n","Processing batch 501/622\n","Processing batch 502/622\n","Processing batch 503/622\n","Processing batch 504/622\n","Processing batch 505/622\n","Processing batch 506/622\n","Processing batch 507/622\n","Processing batch 508/622\n","Processing batch 509/622\n","Processing batch 510/622\n","Processing batch 511/622\n","Processing batch 512/622\n","Processing batch 513/622\n","Processing batch 514/622\n","Processing batch 515/622\n","Processing batch 516/622\n","Processing batch 517/622\n","Processing batch 518/622\n","Processing batch 519/622\n","Processing batch 520/622\n","Processing batch 521/622\n","Processing batch 522/622\n","Processing batch 523/622\n","Processing batch 524/622\n","Processing batch 525/622\n","Processing batch 526/622\n","Processing batch 527/622\n","Processing batch 528/622\n","Processing batch 529/622\n","Processing batch 530/622\n","Processing batch 531/622\n","Processing batch 532/622\n","Processing batch 533/622\n","Processing batch 534/622\n","Processing batch 535/622\n","Processing batch 536/622\n","Processing batch 537/622\n","Processing batch 538/622\n","Processing batch 539/622\n","Processing batch 540/622\n","Processing batch 541/622\n","Processing batch 542/622\n","Processing batch 543/622\n","Processing batch 544/622\n","Processing batch 545/622\n","Processing batch 546/622\n","Processing batch 547/622\n","Processing batch 548/622\n","Processing batch 549/622\n","Processing batch 550/622\n","Processing batch 551/622\n","Processing batch 552/622\n","Processing batch 553/622\n","Processing batch 554/622\n","Processing batch 555/622\n","Processing batch 556/622\n","Processing batch 557/622\n","Processing batch 558/622\n","Processing batch 559/622\n","Processing batch 560/622\n","Processing batch 561/622\n","Processing batch 562/622\n","Processing batch 563/622\n","Processing batch 564/622\n","Processing batch 565/622\n","Processing batch 566/622\n","Processing batch 567/622\n","Processing batch 568/622\n","Processing batch 569/622\n","Processing batch 570/622\n","Processing batch 571/622\n","Processing batch 572/622\n","Processing batch 573/622\n","Processing batch 574/622\n","Processing batch 575/622\n","Processing batch 576/622\n","Processing batch 577/622\n","Processing batch 578/622\n","Processing batch 579/622\n","Processing batch 580/622\n","Processing batch 581/622\n","Processing batch 582/622\n","Processing batch 583/622\n","Processing batch 584/622\n","Processing batch 585/622\n","Processing batch 586/622\n","Processing batch 587/622\n","Processing batch 588/622\n","Processing batch 589/622\n","Processing batch 590/622\n","Processing batch 591/622\n","Processing batch 592/622\n","Processing batch 593/622\n","Processing batch 594/622\n","Processing batch 595/622\n","Processing batch 596/622\n","Processing batch 597/622\n","Processing batch 598/622\n","Processing batch 599/622\n","Processing batch 600/622\n","Processing batch 601/622\n","Processing batch 602/622\n","Processing batch 603/622\n","Processing batch 604/622\n","Processing batch 605/622\n","Processing batch 606/622\n","Processing batch 607/622\n","Processing batch 608/622\n","Processing batch 609/622\n","Processing batch 610/622\n","Processing batch 611/622\n","Processing batch 612/622\n","Processing batch 613/622\n","Processing batch 614/622\n","Processing batch 615/622\n","Processing batch 616/622\n","Processing batch 617/622\n","Processing batch 618/622\n","Processing batch 619/622\n","Processing batch 620/622\n","Processing batch 621/622\n","Processing batch 622/622\n","Processing batch 1/208\n","Processing batch 2/208\n","Processing batch 3/208\n","Processing batch 4/208\n","Processing batch 5/208\n","Processing batch 6/208\n","Processing batch 7/208\n","Processing batch 8/208\n","Processing batch 9/208\n","Processing batch 10/208\n","Processing batch 11/208\n","Processing batch 12/208\n","Processing batch 13/208\n","Processing batch 14/208\n","Processing batch 15/208\n","Processing batch 16/208\n","Processing batch 17/208\n","Processing batch 18/208\n","Processing batch 19/208\n","Processing batch 20/208\n","Processing batch 21/208\n","Processing batch 22/208\n","Processing batch 23/208\n","Processing batch 24/208\n","Processing batch 25/208\n","Processing batch 26/208\n","Processing batch 27/208\n","Processing batch 28/208\n","Processing batch 29/208\n","Processing batch 30/208\n","Processing batch 31/208\n","Processing batch 32/208\n","Processing batch 33/208\n","Processing batch 34/208\n","Processing batch 35/208\n","Processing batch 36/208\n","Processing batch 37/208\n","Processing batch 38/208\n","Processing batch 39/208\n","Processing batch 40/208\n","Processing batch 41/208\n","Processing batch 42/208\n","Processing batch 43/208\n","Processing batch 44/208\n","Processing batch 45/208\n","Processing batch 46/208\n","Processing batch 47/208\n","Processing batch 48/208\n","Processing batch 49/208\n","Processing batch 50/208\n","Processing batch 51/208\n","Processing batch 52/208\n","Processing batch 53/208\n","Processing batch 54/208\n","Processing batch 55/208\n","Processing batch 56/208\n","Processing batch 57/208\n","Processing batch 58/208\n","Processing batch 59/208\n","Processing batch 60/208\n","Processing batch 61/208\n","Processing batch 62/208\n","Processing batch 63/208\n","Processing batch 64/208\n","Processing batch 65/208\n","Processing batch 66/208\n","Processing batch 67/208\n","Processing batch 68/208\n","Processing batch 69/208\n","Processing batch 70/208\n","Processing batch 71/208\n","Processing batch 72/208\n","Processing batch 73/208\n","Processing batch 74/208\n","Processing batch 75/208\n","Processing batch 76/208\n","Processing batch 77/208\n","Processing batch 78/208\n","Processing batch 79/208\n","Processing batch 80/208\n","Processing batch 81/208\n","Processing batch 82/208\n","Processing batch 83/208\n","Processing batch 84/208\n","Processing batch 85/208\n","Processing batch 86/208\n","Processing batch 87/208\n","Processing batch 88/208\n","Processing batch 89/208\n","Processing batch 90/208\n","Processing batch 91/208\n","Processing batch 92/208\n","Processing batch 93/208\n","Processing batch 94/208\n","Processing batch 95/208\n","Processing batch 96/208\n","Processing batch 97/208\n","Processing batch 98/208\n","Processing batch 99/208\n","Processing batch 100/208\n","Processing batch 101/208\n","Processing batch 102/208\n","Processing batch 103/208\n","Processing batch 104/208\n","Processing batch 105/208\n","Processing batch 106/208\n","Processing batch 107/208\n","Processing batch 108/208\n","Processing batch 109/208\n","Processing batch 110/208\n","Processing batch 111/208\n","Processing batch 112/208\n","Processing batch 113/208\n","Processing batch 114/208\n","Processing batch 115/208\n","Processing batch 116/208\n","Processing batch 117/208\n","Processing batch 118/208\n","Processing batch 119/208\n","Processing batch 120/208\n","Processing batch 121/208\n","Processing batch 122/208\n","Processing batch 123/208\n","Processing batch 124/208\n","Processing batch 125/208\n","Processing batch 126/208\n","Processing batch 127/208\n","Processing batch 128/208\n","Processing batch 129/208\n","Processing batch 130/208\n","Processing batch 131/208\n","Processing batch 132/208\n","Processing batch 133/208\n","Processing batch 134/208\n","Processing batch 135/208\n","Processing batch 136/208\n","Processing batch 137/208\n","Processing batch 138/208\n","Processing batch 139/208\n","Processing batch 140/208\n","Processing batch 141/208\n","Processing batch 142/208\n","Processing batch 143/208\n","Processing batch 144/208\n","Processing batch 145/208\n","Processing batch 146/208\n","Processing batch 147/208\n","Processing batch 148/208\n","Processing batch 149/208\n","Processing batch 150/208\n","Processing batch 151/208\n","Processing batch 152/208\n","Processing batch 153/208\n","Processing batch 154/208\n","Processing batch 155/208\n","Processing batch 156/208\n","Processing batch 157/208\n","Processing batch 158/208\n","Processing batch 159/208\n","Processing batch 160/208\n","Processing batch 161/208\n","Processing batch 162/208\n","Processing batch 163/208\n","Processing batch 164/208\n","Processing batch 165/208\n","Processing batch 166/208\n","Processing batch 167/208\n","Processing batch 168/208\n","Processing batch 169/208\n","Processing batch 170/208\n","Processing batch 171/208\n","Processing batch 172/208\n","Processing batch 173/208\n","Processing batch 174/208\n","Processing batch 175/208\n","Processing batch 176/208\n","Processing batch 177/208\n","Processing batch 178/208\n","Processing batch 179/208\n","Processing batch 180/208\n","Processing batch 181/208\n","Processing batch 182/208\n","Processing batch 183/208\n","Processing batch 184/208\n","Processing batch 185/208\n","Processing batch 186/208\n","Processing batch 187/208\n","Processing batch 188/208\n","Processing batch 189/208\n","Processing batch 190/208\n","Processing batch 191/208\n","Processing batch 192/208\n","Processing batch 193/208\n","Processing batch 194/208\n","Processing batch 195/208\n","Processing batch 196/208\n","Processing batch 197/208\n","Processing batch 198/208\n","Processing batch 199/208\n","Processing batch 200/208\n","Processing batch 201/208\n","Processing batch 202/208\n","Processing batch 203/208\n","Processing batch 204/208\n","Processing batch 205/208\n","Processing batch 206/208\n","Processing batch 207/208\n","Processing batch 208/208\n","Processing batch 1/21\n","Processing batch 2/21\n","Processing batch 3/21\n","Processing batch 4/21\n","Processing batch 5/21\n","Processing batch 6/21\n","Processing batch 7/21\n","Processing batch 8/21\n","Processing batch 9/21\n","Processing batch 10/21\n","Processing batch 11/21\n","Processing batch 12/21\n","Processing batch 13/21\n","Processing batch 14/21\n","Processing batch 15/21\n","Processing batch 16/21\n","Processing batch 17/21\n","Processing batch 18/21\n","Processing batch 19/21\n","Processing batch 20/21\n","Processing batch 21/21\n"]}],"execution_count":18},{"id":"5997b9ed","cell_type":"code","source":"train_df.reset_index(drop=True, inplace=True)\nval_df.reset_index(drop=True, inplace=True)\ntest_df.reset_index(drop=True, inplace=True)","metadata":{"execution":{"iopub.execute_input":"2025-02-13T13:11:07.176143Z","iopub.status.busy":"2025-02-13T13:11:07.175805Z","iopub.status.idle":"2025-02-13T13:11:07.179708Z","shell.execute_reply":"2025-02-13T13:11:07.179067Z"},"papermill":{"duration":0.044782,"end_time":"2025-02-13T13:11:07.180812","exception":false,"start_time":"2025-02-13T13:11:07.136030","status":"completed"},"tags":[]},"outputs":[],"execution_count":19},{"id":"33b0b6ed","cell_type":"code","source":"train_embedded_df=pd.concat([train_df,train_embedded],axis=1)\nval_embedded_df=pd.concat([val_df,val_embedded],axis=1)\ntest_embedded_df=pd.concat([test_df,test_embedded],axis=1)","metadata":{"execution":{"iopub.execute_input":"2025-02-13T13:11:07.260102Z","iopub.status.busy":"2025-02-13T13:11:07.259890Z","iopub.status.idle":"2025-02-13T13:11:07.305655Z","shell.execute_reply":"2025-02-13T13:11:07.304990Z"},"papermill":{"duration":0.087013,"end_time":"2025-02-13T13:11:07.307051","exception":false,"start_time":"2025-02-13T13:11:07.220038","status":"completed"},"tags":[]},"outputs":[],"execution_count":20},{"id":"54718094","cell_type":"code","source":"train_embedded_df.to_csv(\"/kaggle/working/train_embedded_df.csv\",index=False)\nval_embedded_df.to_csv(\"/kaggle/working/val_embedded_df.csv\",index=False)\ntest_embedded_df.to_csv(\"/kaggle/working/test_embedded_df.csv\",index=False)","metadata":{"execution":{"iopub.execute_input":"2025-02-13T13:11:07.387999Z","iopub.status.busy":"2025-02-13T13:11:07.387770Z","iopub.status.idle":"2025-02-13T13:11:44.548656Z","shell.execute_reply":"2025-02-13T13:11:44.547372Z"},"papermill":{"duration":37.202964,"end_time":"2025-02-13T13:11:44.550525","exception":false,"start_time":"2025-02-13T13:11:07.347561","status":"completed"},"tags":[]},"outputs":[],"execution_count":21},{"id":"6ac71760-b324-4c10-a787-93688abfb626","cell_type":"code","source":"save_directory = \"./saved_model\"\n\n# Save model and tokenizer\nmodel.save_pretrained(save_directory)\ntokenizer.save_pretrained(save_directory)","metadata":{"trusted":true},"outputs":[],"execution_count":null}]}