{"metadata":{"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.12"},"kaggle":{"accelerator":"gpu","dataSources":[{"sourceId":85506,"databundleVersionId":9687564,"sourceType":"competition"}],"dockerImageVersionId":30919,"isInternetEnabled":true,"language":"python","sourceType":"notebook","isGpuEnabled":true},"papermill":{"default_parameters":{},"duration":5776.133053,"end_time":"2025-02-15T05:56:52.241035","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-02-15T04:20:36.107982","version":"2.6.0"},"widgets":{"application/vnd.jupyter.widget-state+json":{"state":{"057b9ad7ef4d480c9b07c698006f16a0":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0a0ccdb57e8a4213b2cd9cf3694a6072":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"10429e34a60b40eea19d6d4af3759a7c":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"16fe6a97bd4d45ff88da8e09ae2e5240":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"1bf455d84e2947f1bd8696e4adead484":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"1df4eb1ed3924645a3548463ee7bde83":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"27499929e2dd436885fef9dd2dc8e04f":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2c2c9c28871141d7b5e31b63d18c1d28":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2f26cc49c09246ab8fec7eb2bc43046e":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_10429e34a60b40eea19d6d4af3759a7c","placeholder":"​","style":"IPY_MODEL_16fe6a97bd4d45ff88da8e09ae2e5240","tabbable":null,"tooltip":null,"value":" 213k/213k [00:00&lt;00:00, 4.82MB/s]"}},"38e22fb8bad9486d8dc20eeefec14dd9":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"3d5b9a87243b414682d8761a4fb93624":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_aae19775ebd24e94b7f3dff305164b02","max":263260784,"min":0,"orientation":"horizontal","style":"IPY_MODEL_52b89bda58f54f26955b141e1ab5737f","tabbable":null,"tooltip":null,"value":263260784}},"3efb5e76cc514385b1d47c06e1690bfe":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"41f99cd3a057407c8e43d31f729353df":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_eacc7d08bafc4540b7a7c16ea6e29a75","placeholder":"​","style":"IPY_MODEL_38e22fb8bad9486d8dc20eeefec14dd9","tabbable":null,"tooltip":null,"value":"config.json: 100%"}},"422d0483ee5a4f75b34bf700660b41fa":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_b4b4087cbb3044ae806ef3f1f80afeed","placeholder":"​","style":"IPY_MODEL_47b19a90e3d844e091647fd6dda67fff","tabbable":null,"tooltip":null,"value":"tokenizer.json: 100%"}},"47b19a90e3d844e091647fd6dda67fff":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"5164f136fd4842d291c35e9487460f58":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"52b89bda58f54f26955b141e1ab5737f":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"56bb46c715704fbc838ca02d3865f835":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_f0e4e79955d34ae9973cc21a25673718","placeholder":"​","style":"IPY_MODEL_be93e7ea00734fddbb5136da3e0602f9","tabbable":null,"tooltip":null,"value":" 49.0/49.0 [00:00&lt;00:00, 3.93kB/s]"}},"59fafe5689894eaaa7ca2a6409525a8c":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_2c2c9c28871141d7b5e31b63d18c1d28","max":49,"min":0,"orientation":"horizontal","style":"IPY_MODEL_71c9d138a1174504b9916ae00fd8ccf6","tabbable":null,"tooltip":null,"value":49}},"5d410215a1224830ab6b00c4a8f9e00e":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"668d47ad02d546039d06ce1d476f8827":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_8402cf96f69148858604871b87b79307","IPY_MODEL_3d5b9a87243b414682d8761a4fb93624","IPY_MODEL_b82b4fd09d9e41a0b4adfedc743441ce"],"layout":"IPY_MODEL_5164f136fd4842d291c35e9487460f58","tabbable":null,"tooltip":null}},"68d3ee2f58fc4772b1be95413544549f":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_1df4eb1ed3924645a3548463ee7bde83","placeholder":"​","style":"IPY_MODEL_af97b7793f5c4a52884d1f0700d3d1ba","tabbable":null,"tooltip":null,"value":" 465/465 [00:00&lt;00:00, 42.4kB/s]"}},"71c9d138a1174504b9916ae00fd8ccf6":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"72627da60d34407d88a04a53b887f9f9":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_dc72fdb1d1af41cb82bf21ff6230a448","IPY_MODEL_59fafe5689894eaaa7ca2a6409525a8c","IPY_MODEL_56bb46c715704fbc838ca02d3865f835"],"layout":"IPY_MODEL_d718f1bf8d3347e7ba1cd0c04e8e9ead","tabbable":null,"tooltip":null}},"73c7bf2426fc42bc8898f9d986d4dd67":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e2b211d7b8814aba9753c0e30e888c68","IPY_MODEL_7a99094065e04ac685548b6a90cff91c","IPY_MODEL_2f26cc49c09246ab8fec7eb2bc43046e"],"layout":"IPY_MODEL_3efb5e76cc514385b1d47c06e1690bfe","tabbable":null,"tooltip":null}},"73c805c810b34f2e8597d98740b3ce33":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_df91d49ce531484eacf11c69a8d69326","max":465,"min":0,"orientation":"horizontal","style":"IPY_MODEL_c889b72bb4bd46c1a6df049a468f4332","tabbable":null,"tooltip":null,"value":465}},"7a99094065e04ac685548b6a90cff91c":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_ff8ad5c96ee34df88f4f5a2f014dbcd4","max":213450,"min":0,"orientation":"horizontal","style":"IPY_MODEL_9b1895f1e93c44818f4c300fcf053e71","tabbable":null,"tooltip":null,"value":213450}},"8402cf96f69148858604871b87b79307":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_e310382919d74a38b8e56cb2d116b442","placeholder":"​","style":"IPY_MODEL_0a0ccdb57e8a4213b2cd9cf3694a6072","tabbable":null,"tooltip":null,"value":"model.safetensors: 100%"}},"9b1895f1e93c44818f4c300fcf053e71":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a27450296fde49c8ac876536a890a96d":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"a9430725f3a1441db9e36135039d24b7":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_422d0483ee5a4f75b34bf700660b41fa","IPY_MODEL_cb60401c351442aa8c42d0a6f84e3001","IPY_MODEL_aa1da4794a26431a99ab4d93dbc2d7b0"],"layout":"IPY_MODEL_da73809d5ea54c4c870355d26eb3f36e","tabbable":null,"tooltip":null}},"aa1da4794a26431a99ab4d93dbc2d7b0":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_5d410215a1224830ab6b00c4a8f9e00e","placeholder":"​","style":"IPY_MODEL_f9ee0178ec084cdc8ac2bdd329ef787b","tabbable":null,"tooltip":null,"value":" 436k/436k [00:00&lt;00:00, 22.9MB/s]"}},"aae19775ebd24e94b7f3dff305164b02":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ad18b81c88cb4961bfa1b90dbb8e085d":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"af97b7793f5c4a52884d1f0700d3d1ba":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"b4b4087cbb3044ae806ef3f1f80afeed":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b6e045aa21d54622beae4c58ed032fb2":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"b82b4fd09d9e41a0b4adfedc743441ce":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_ad18b81c88cb4961bfa1b90dbb8e085d","placeholder":"​","style":"IPY_MODEL_b6e045aa21d54622beae4c58ed032fb2","tabbable":null,"tooltip":null,"value":" 263M/263M [00:01&lt;00:00, 234MB/s]"}},"be93e7ea00734fddbb5136da3e0602f9":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"c889b72bb4bd46c1a6df049a468f4332":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"ProgressStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"cb60401c351442aa8c42d0a6f84e3001":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"FloatProgressModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"ProgressView","bar_style":"success","description":"","description_allow_html":false,"layout":"IPY_MODEL_057b9ad7ef4d480c9b07c698006f16a0","max":435797,"min":0,"orientation":"horizontal","style":"IPY_MODEL_1bf455d84e2947f1bd8696e4adead484","tabbable":null,"tooltip":null,"value":435797}},"d718f1bf8d3347e7ba1cd0c04e8e9ead":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"da73809d5ea54c4c870355d26eb3f36e":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"dc72fdb1d1af41cb82bf21ff6230a448":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_f9c2383a63154076b764cebbe9a5a3d1","placeholder":"​","style":"IPY_MODEL_a27450296fde49c8ac876536a890a96d","tabbable":null,"tooltip":null,"value":"tokenizer_config.json: 100%"}},"df91d49ce531484eacf11c69a8d69326":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e2b211d7b8814aba9753c0e30e888c68":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HTMLView","description":"","description_allow_html":false,"layout":"IPY_MODEL_ec59af3e3c89459185f681a1d9934669","placeholder":"​","style":"IPY_MODEL_f945461eef4b4755a9ed037a723b924a","tabbable":null,"tooltip":null,"value":"vocab.txt: 100%"}},"e310382919d74a38b8e56cb2d116b442":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"eacc7d08bafc4540b7a7c16ea6e29a75":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ec59af3e3c89459185f681a1d9934669":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f0e4e79955d34ae9973cc21a25673718":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f26a57100728431a94947313717784ee":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HBoxModel","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"2.0.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_41f99cd3a057407c8e43d31f729353df","IPY_MODEL_73c805c810b34f2e8597d98740b3ce33","IPY_MODEL_68d3ee2f58fc4772b1be95413544549f"],"layout":"IPY_MODEL_27499929e2dd436885fef9dd2dc8e04f","tabbable":null,"tooltip":null}},"f945461eef4b4755a9ed037a723b924a":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"f9c2383a63154076b764cebbe9a5a3d1":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f9ee0178ec084cdc8ac2bdd329ef787b":{"model_module":"@jupyter-widgets/controls","model_module_version":"2.0.0","model_name":"HTMLStyleModel","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"2.0.0","_model_name":"HTMLStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"StyleView","background":null,"description_width":"","font_size":null,"text_color":null}},"ff8ad5c96ee34df88f4f5a2f014dbcd4":{"model_module":"@jupyter-widgets/base","model_module_version":"2.0.0","model_name":"LayoutModel","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"2.0.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"2.0.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border_bottom":null,"border_left":null,"border_right":null,"border_top":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}}},"version_major":2,"version_minor":0}}},"nbformat_minor":5,"nbformat":4,"cells":[{"id":"fc898028","cell_type":"code","source":"from transformers import AutoModelForMaskedLM, AutoTokenizer, Trainer, TrainingArguments,EarlyStoppingCallback, DataCollatorForLanguageModeling\nimport pandas as pd\nfrom datasets import Dataset\nimport torch\nimport numpy as np\nfrom safetensors.torch import load_file","metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2025-02-15T04:20:39.064598Z","iopub.status.busy":"2025-02-15T04:20:39.064222Z","iopub.status.idle":"2025-02-15T04:21:06.962428Z","shell.execute_reply":"2025-02-15T04:21:06.961628Z"},"papermill":{"duration":27.905103,"end_time":"2025-02-15T04:21:06.964231","exception":false,"start_time":"2025-02-15T04:20:39.059128","status":"completed"},"tags":[]},"outputs":[],"execution_count":1},{"id":"b6af934a","cell_type":"code","source":"model_name = \"distilbert-base-cased\"\ntokenizer = AutoTokenizer.from_pretrained(model_name)\nmodel = AutoModelForMaskedLM.from_pretrained(model_name)","metadata":{"execution":{"iopub.execute_input":"2025-02-15T04:21:06.972880Z","iopub.status.busy":"2025-02-15T04:21:06.972233Z","iopub.status.idle":"2025-02-15T04:21:12.170137Z","shell.execute_reply":"2025-02-15T04:21:12.169107Z"},"papermill":{"duration":5.2037,"end_time":"2025-02-15T04:21:12.171779","exception":false,"start_time":"2025-02-15T04:21:06.968079","status":"completed"},"tags":[]},"outputs":[{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"72627da60d34407d88a04a53b887f9f9","version_major":2,"version_minor":0},"text/plain":["tokenizer_config.json:   0%|          | 0.00/49.0 [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"},{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"f26a57100728431a94947313717784ee","version_major":2,"version_minor":0},"text/plain":["config.json:   0%|          | 0.00/465 [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"},{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"73c7bf2426fc42bc8898f9d986d4dd67","version_major":2,"version_minor":0},"text/plain":["vocab.txt:   0%|          | 0.00/213k [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"},{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"a9430725f3a1441db9e36135039d24b7","version_major":2,"version_minor":0},"text/plain":["tokenizer.json:   0%|          | 0.00/436k [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"},{"data":{"application/vnd.jupyter.widget-view+json":{"model_id":"668d47ad02d546039d06ce1d476f8827","version_major":2,"version_minor":0},"text/plain":["model.safetensors:   0%|          | 0.00/263M [00:00<?, ?B/s]"]},"metadata":{},"output_type":"display_data"},{"data":{"text/plain":["_IncompatibleKeys(missing_keys=['vocab_projector.weight'], unexpected_keys=[])"]},"execution_count":2,"metadata":{},"output_type":"execute_result"}],"execution_count":2},{"id":"faca738f","cell_type":"code","source":"df=pd.read_csv(\"/kaggle/input/isec-sdc-2025/train.csv\")\ntest_df=pd.read_csv(\"/kaggle/input/isec-sdc-2025/test.csv\")","metadata":{"execution":{"iopub.execute_input":"2025-02-15T04:21:12.183646Z","iopub.status.busy":"2025-02-15T04:21:12.183279Z","iopub.status.idle":"2025-02-15T04:21:13.560611Z","shell.execute_reply":"2025-02-15T04:21:13.559392Z"},"papermill":{"duration":1.385304,"end_time":"2025-02-15T04:21:13.562695","exception":false,"start_time":"2025-02-15T04:21:12.177391","status":"completed"},"tags":[]},"outputs":[],"execution_count":3},{"id":"59fea12d","cell_type":"code","source":"# df,test_df=df[:1000],test_df[:100]","metadata":{"execution":{"iopub.execute_input":"2025-02-15T04:21:13.572194Z","iopub.status.busy":"2025-02-15T04:21:13.571802Z","iopub.status.idle":"2025-02-15T04:21:13.575412Z","shell.execute_reply":"2025-02-15T04:21:13.574579Z"},"papermill":{"duration":0.009956,"end_time":"2025-02-15T04:21:13.576973","exception":false,"start_time":"2025-02-15T04:21:13.567017","status":"completed"},"tags":[]},"outputs":[],"execution_count":4},{"id":"c0755356","cell_type":"code","source":"df[\"Description\"]=df[\"Description\"].fillna(\"Not provided\")\ntest_df[\"Description\"]=test_df[\"Description\"].fillna(\"Not provided\")","metadata":{"execution":{"iopub.execute_input":"2025-02-15T04:21:13.586329Z","iopub.status.busy":"2025-02-15T04:21:13.586037Z","iopub.status.idle":"2025-02-15T04:21:13.607734Z","shell.execute_reply":"2025-02-15T04:21:13.606991Z"},"papermill":{"duration":0.028136,"end_time":"2025-02-15T04:21:13.609331","exception":false,"start_time":"2025-02-15T04:21:13.581195","status":"completed"},"tags":[]},"outputs":[],"execution_count":5},{"id":"bf8ebce9","cell_type":"code","source":"from sklearn.model_selection import train_test_split\ntrain_df, val_df = train_test_split(df, test_size=0.25, random_state=7,stratify=df['Priority'])","metadata":{"execution":{"iopub.execute_input":"2025-02-15T04:21:13.618522Z","iopub.status.busy":"2025-02-15T04:21:13.618219Z","iopub.status.idle":"2025-02-15T04:21:13.672610Z","shell.execute_reply":"2025-02-15T04:21:13.671723Z"},"papermill":{"duration":0.060941,"end_time":"2025-02-15T04:21:13.674463","exception":false,"start_time":"2025-02-15T04:21:13.613522","status":"completed"},"tags":[]},"outputs":[],"execution_count":6},{"id":"de00e370","cell_type":"code","source":"device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\nmodel.to(device)  # Move model to device","metadata":{"execution":{"iopub.execute_input":"2025-02-15T04:21:13.683596Z","iopub.status.busy":"2025-02-15T04:21:13.683269Z","iopub.status.idle":"2025-02-15T04:21:14.044988Z","shell.execute_reply":"2025-02-15T04:21:14.043931Z"},"papermill":{"duration":0.368073,"end_time":"2025-02-15T04:21:14.046611","exception":false,"start_time":"2025-02-15T04:21:13.678538","status":"completed"},"tags":[]},"outputs":[{"data":{"text/plain":["DistilBertForMaskedLM(\n","  (activation): GELUActivation()\n","  (distilbert): DistilBertModel(\n","    (embeddings): Embeddings(\n","      (word_embeddings): Embedding(28996, 768, padding_idx=0)\n","      (position_embeddings): Embedding(512, 768)\n","      (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      (dropout): Dropout(p=0.1, inplace=False)\n","    )\n","    (transformer): Transformer(\n","      (layer): ModuleList(\n","        (0-5): 6 x TransformerBlock(\n","          (attention): DistilBertSdpaAttention(\n","            (dropout): Dropout(p=0.1, inplace=False)\n","            (q_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (k_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (v_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (out_lin): Linear(in_features=768, out_features=768, bias=True)\n","          )\n","          (sa_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","          (ffn): FFN(\n","            (dropout): Dropout(p=0.1, inplace=False)\n","            (lin1): Linear(in_features=768, out_features=3072, bias=True)\n","            (lin2): Linear(in_features=3072, out_features=768, bias=True)\n","            (activation): GELUActivation()\n","          )\n","          (output_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        )\n","      )\n","    )\n","  )\n","  (vocab_transform): Linear(in_features=768, out_features=768, bias=True)\n","  (vocab_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","  (vocab_projector): Linear(in_features=768, out_features=28996, bias=True)\n","  (mlm_loss_fct): CrossEntropyLoss()\n",")"]},"execution_count":7,"metadata":{},"output_type":"execute_result"}],"execution_count":7},{"id":"84e7ea47","cell_type":"code","source":"def tokenize_data(components, titles, descriptions,statuss,resolutions,max_length=512):\n    combined_texts = [f\"{status} [SEP] {resolution} [SEP] {component} [SEP] {title} [SEP] {description}\" \n                      for status,resolution,component, title, description in zip(statuss,resolutions,components, titles, descriptions)]\n    \n    # Tokenize the combined texts\n    inputs = tokenizer(combined_texts, padding=True, truncation=True, return_tensors=\"pt\", max_length=max_length)\n    \n    return inputs","metadata":{"execution":{"iopub.execute_input":"2025-02-15T04:21:14.056178Z","iopub.status.busy":"2025-02-15T04:21:14.055849Z","iopub.status.idle":"2025-02-15T04:21:14.060593Z","shell.execute_reply":"2025-02-15T04:21:14.059602Z"},"papermill":{"duration":0.011086,"end_time":"2025-02-15T04:21:14.062107","exception":false,"start_time":"2025-02-15T04:21:14.051021","status":"completed"},"tags":[]},"outputs":[],"execution_count":8},{"id":"bb711284","cell_type":"code","source":"def create_dataset(inputs):\n    data = Dataset.from_dict({\n            'input_ids': inputs['input_ids'],\n            'attention_mask': inputs['attention_mask'],\n            'labels': inputs['input_ids']\n        })\n    return data","metadata":{"execution":{"iopub.execute_input":"2025-02-15T04:21:14.071425Z","iopub.status.busy":"2025-02-15T04:21:14.071132Z","iopub.status.idle":"2025-02-15T04:21:14.075235Z","shell.execute_reply":"2025-02-15T04:21:14.074421Z"},"papermill":{"duration":0.010311,"end_time":"2025-02-15T04:21:14.076644","exception":false,"start_time":"2025-02-15T04:21:14.066333","status":"completed"},"tags":[]},"outputs":[],"execution_count":9},{"id":"5c1427ba","cell_type":"code","source":"train_inputs=tokenize_data(train_df[\"Component\"],train_df[\"Title\"],train_df[\"Description\"],train_df[\"Status\"],train_df[\"Resolution\"])\nval_inputs=tokenize_data(val_df[\"Component\"],val_df[\"Title\"],val_df[\"Description\"],val_df[\"Status\"],val_df[\"Resolution\"])\ntest_inputs=tokenize_data(test_df[\"Component\"],test_df[\"Title\"],test_df[\"Description\"],test_df[\"Status\"],test_df[\"Resolution\"])","metadata":{"execution":{"iopub.execute_input":"2025-02-15T04:21:14.086322Z","iopub.status.busy":"2025-02-15T04:21:14.086040Z","iopub.status.idle":"2025-02-15T04:21:44.666782Z","shell.execute_reply":"2025-02-15T04:21:44.665998Z"},"papermill":{"duration":30.587547,"end_time":"2025-02-15T04:21:44.668685","exception":false,"start_time":"2025-02-15T04:21:14.081138","status":"completed"},"tags":[]},"outputs":[],"execution_count":10},{"id":"f91ad9e8","cell_type":"code","source":"train_data=create_dataset(train_inputs)\nval_data=create_dataset(val_inputs)","metadata":{"execution":{"iopub.execute_input":"2025-02-15T04:21:44.678167Z","iopub.status.busy":"2025-02-15T04:21:44.677807Z","iopub.status.idle":"2025-02-15T04:21:51.837903Z","shell.execute_reply":"2025-02-15T04:21:51.837042Z"},"papermill":{"duration":7.166465,"end_time":"2025-02-15T04:21:51.839553","exception":false,"start_time":"2025-02-15T04:21:44.673088","status":"completed"},"tags":[]},"outputs":[],"execution_count":11},{"id":"91a63727","cell_type":"code","source":"data_collator = DataCollatorForLanguageModeling(tokenizer=tokenizer, mlm=True, mlm_probability=0.15)","metadata":{"execution":{"iopub.execute_input":"2025-02-15T04:21:51.849093Z","iopub.status.busy":"2025-02-15T04:21:51.848742Z","iopub.status.idle":"2025-02-15T04:21:51.852802Z","shell.execute_reply":"2025-02-15T04:21:51.851808Z"},"papermill":{"duration":0.010675,"end_time":"2025-02-15T04:21:51.854415","exception":false,"start_time":"2025-02-15T04:21:51.843740","status":"completed"},"tags":[]},"outputs":[],"execution_count":12},{"id":"bdb1d581","cell_type":"code","source":"def fine_tune_model(train_data,epochs=10):\n    training_args = TrainingArguments(\n        output_dir='./results',\n        overwrite_output_dir=True,\n        logging_dir='./logs',\n        logging_strategy=\"steps\",\n        eval_strategy=\"steps\", \n        save_strategy=\"steps\",\n        logging_steps=1500,\n        warmup_steps=2500,\n        eval_steps=1500,\n        save_steps=1500,\n        num_train_epochs=epochs,\n        per_device_eval_batch_size=64,\n        per_device_train_batch_size=16,\n        # gradient_accumulation_steps=2,  # Gradient accumulation step size\n        seed=7,\n        fp16=True,\n        report_to=[],\n        optim=\"adafactor\",\n        weight_decay=0.01,\n        load_best_model_at_end=True,\n        save_total_limit=3,\n        disable_tqdm=True,\n    )\n\n    # Initialize Trainer\n    trainer = Trainer(\n        model=model,\n        args=training_args,\n        train_dataset=train_data,\n        eval_dataset=val_data,\n        data_collator=data_collator,\n        callbacks = [EarlyStoppingCallback(early_stopping_patience=1)]\n    )\n\n    # Train the model\n    trainer.train()\n","metadata":{"execution":{"iopub.execute_input":"2025-02-15T04:21:51.863196Z","iopub.status.busy":"2025-02-15T04:21:51.862931Z","iopub.status.idle":"2025-02-15T04:21:51.868310Z","shell.execute_reply":"2025-02-15T04:21:51.867424Z"},"papermill":{"duration":0.011047,"end_time":"2025-02-15T04:21:51.869663","exception":false,"start_time":"2025-02-15T04:21:51.858616","status":"completed"},"tags":[]},"outputs":[],"execution_count":13},{"id":"d61b5a06","cell_type":"code","source":"fine_tune_model(train_data)","metadata":{"execution":{"iopub.execute_input":"2025-02-15T04:21:51.878395Z","iopub.status.busy":"2025-02-15T04:21:51.878107Z","iopub.status.idle":"2025-02-15T05:56:49.008411Z","shell.execute_reply":"2025-02-15T05:56:49.007478Z"},"papermill":{"duration":5697.136201,"end_time":"2025-02-15T05:56:49.009854","exception":false,"start_time":"2025-02-15T04:21:51.873653","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["{'loss': 1.2912, 'grad_norm': 6.015302658081055, 'learning_rate': 8.926462694578637e-06, 'epoch': 0.32180209171359614}\n","{'eval_loss': 1.494544506072998, 'eval_runtime': 166.9556, 'eval_samples_per_second': 79.356, 'eval_steps_per_second': 1.246, 'epoch': 0.32180209171359614}\n","{'loss': 1.2703, 'grad_norm': 5.927941799163818, 'learning_rate': 7.85829307568438e-06, 'epoch': 0.6436041834271923}\n","{'eval_loss': 1.4895092248916626, 'eval_runtime': 165.4992, 'eval_samples_per_second': 80.055, 'eval_steps_per_second': 1.257, 'epoch': 0.6436041834271923}\n","{'loss': 1.2775, 'grad_norm': 6.489722728729248, 'learning_rate': 6.784755770263017e-06, 'epoch': 0.9654062751407884}\n","{'eval_loss': 1.4970835447311401, 'eval_runtime': 165.4896, 'eval_samples_per_second': 80.059, 'eval_steps_per_second': 1.257, 'epoch': 0.9654062751407884}\n","{'loss': 1.2853, 'grad_norm': 6.703510761260986, 'learning_rate': 5.711218464841653e-06, 'epoch': 1.2864038616251006}\n","{'eval_loss': 1.4890637397766113, 'eval_runtime': 165.4511, 'eval_samples_per_second': 80.078, 'eval_steps_per_second': 1.257, 'epoch': 1.2864038616251006}\n","{'loss': 1.3155, 'grad_norm': 6.021096229553223, 'learning_rate': 4.637681159420291e-06, 'epoch': 1.6082059533386968}\n","{'eval_loss': 1.4728710651397705, 'eval_runtime': 165.8884, 'eval_samples_per_second': 79.867, 'eval_steps_per_second': 1.254, 'epoch': 1.6082059533386968}\n","{'loss': 1.3598, 'grad_norm': 6.750750541687012, 'learning_rate': 3.5695115405260335e-06, 'epoch': 1.930008045052293}\n","{'eval_loss': 1.466256022453308, 'eval_runtime': 165.7642, 'eval_samples_per_second': 79.927, 'eval_steps_per_second': 1.255, 'epoch': 1.930008045052293}\n","{'loss': 1.3637, 'grad_norm': 6.709559440612793, 'learning_rate': 2.49597423510467e-06, 'epoch': 2.251005631536605}\n","{'eval_loss': 1.4714887142181396, 'eval_runtime': 165.7905, 'eval_samples_per_second': 79.914, 'eval_steps_per_second': 1.255, 'epoch': 2.251005631536605}\n","{'loss': 1.3934, 'grad_norm': 7.08600378036499, 'learning_rate': 1.4224369296833065e-06, 'epoch': 2.572807723250201}\n","{'eval_loss': 1.4619966745376587, 'eval_runtime': 166.0813, 'eval_samples_per_second': 79.774, 'eval_steps_per_second': 1.252, 'epoch': 2.572807723250201}\n","{'loss': 1.4322, 'grad_norm': 7.026203632354736, 'learning_rate': 3.4889962426194316e-07, 'epoch': 2.8946098149637973}\n","{'eval_loss': 1.459836483001709, 'eval_runtime': 165.508, 'eval_samples_per_second': 80.051, 'eval_steps_per_second': 1.257, 'epoch': 2.8946098149637973}\n"]},{"name":"stderr","output_type":"stream","text":["There were missing keys in the checkpoint model loaded: ['vocab_projector.weight'].\n"]},{"name":"stdout","output_type":"stream","text":["{'train_runtime': 5696.7169, 'train_samples_per_second': 20.93, 'train_steps_per_second': 0.327, 'train_loss': 1.336500625487495, 'epoch': 2.9959774738535803}\n"]}],"execution_count":14},{"id":"ed62c4c4-8e0e-4e27-adf0-97744b55d22a","cell_type":"code","source":"save_directory = \"./saved_model\"\n\n# Save model and tokenizer\nmodel.save_pretrained(save_directory)\ntokenizer.save_pretrained(save_directory)","metadata":{"trusted":true},"outputs":[],"execution_count":null}]}